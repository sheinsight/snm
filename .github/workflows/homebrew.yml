name: Create Pull Request to Another Repository

on:
  push:
    branches:
      - dev
 
jobs:
  create-pull-request:
    runs-on: ubuntu-latest
    steps:
      # - name: Check out repository A code
      #   uses: actions/checkout@v2

      - name: Clone repository B
        run: |
          ls -l
          git clone https://x-access-token:${{ secrets.HOMEBREW_GITHUB_TOKEN }}@github.com/ityuany/homebrew-shined.git repo-b
          cd repo-b
          git checkout -b feature-branch
          ls -l

      - name: Copy changes from repository A to repository B
        run: |
          cd repo-b
          ls -l
          git config --global user.email "519495771@qq.com"
          git config --global user.name "ityuany"
          touch hello.txt
          ls -l
          git add hello.txt
          git commit -m "Auto-generated commit from repository A"
          git push origin feature-branch

      - name: Create Pull Request
        uses: peter-evans/create-pull-request@v4
        with:
          token: ${{ secrets.HOMEBREW_GITHUB_TOKEN }}
          commit-message: Auto-generated PR from repository A
          title: '[Auto] Merge changes from repository A'
          path: repo-b
          body: |
            This pull request is auto-generated by GitHub Actions from repository A.
          branch: feature-branch
          base: main